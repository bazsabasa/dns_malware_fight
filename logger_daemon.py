#!/usr/bin/python3

import sys
import os
import subprocess
import json
#cmd = "/root/bin/tplink_smartplug.py -t" + device + "-c info "
hosts = [ "192.168.0.99" ]
devices = [ "192.168.0.80" ]

def check_host(host):
        response=os.system("ping -c 1 -q "+ host)
        if response == 0:
            os.system("logger -t" + sys.argv[0] + " Itthon van " + host)
            return 1
        elif response != 0:
            os.system("logger Nincs itthon" + host)
            return 0
for host in hosts:
    if check_host(host):

def get_device_status(device):
        cmd = "/root/bin/tplink_smartplug.py -t" + device + " -c info "
        os.system(cmd)
        with open('state.txt') as a:
            data=json.load(a)
            print(data["system"]["get_sysinfo"]["relay_state"])


for device in devices:
    get_device_status(device)


